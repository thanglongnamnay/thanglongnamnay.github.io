"use strict";function Shell(t,e,n){let r=!1,i=!1,o=n,c=n;function a(){t.clearRect(200*c,150,150,250)}function u(n,r=1){t.drawImage(e,function(t,e,n){const r=[75,275,475];return r[t]+(r[e]-r[t])*n>>0}(o,c,n)-75,150+50*r>>0,150,200),1===n&&(o=c)}function l(){t.beginPath(),t.arc(75+200*c,380,20,0,2*Math.PI),t.fillStyle="#9E9E9E",t.fill()}return 1===n&&(r=!0),Object.freeze({isLifted:function(){return i},getIndex:function(){return c},getRect:function(){return{x:200*c,y:200,width:150,height:200}},lift:function(t=(()=>{}),...e){if(i)return;let n;i=!0;const o=i=>{n||(n=i);const c=i-n;a(),c<500?(r&&l(),u(0,1-c/500),requestAnimationFrame(o)):(r&&l(),u(0,0),t(...e))};requestAnimationFrame(o)},release:function(t=(()=>{}),...e){if(!i)return;let n;i=!1;const o=i=>{n||(n=i);const c=i-n;a(),c<500?(r&&l(),u(0,c/500),requestAnimationFrame(o)):(r&&l(),u(0,1),t(...e))};requestAnimationFrame(o)},setNewIndex:function(t){c=t},draw:u})}function throttle(t,e){let n=Date.now()-e;return function(...r){Date.now()-n>=e&&(t.apply(this,r),n=Date.now())}}!function(){const t=document.getElementById("canvas"),e=t.getContext("2d"),n=document.getElementById("time"),r=document.getElementById("swapNumber"),i=new Image,o=new Image,c=[[0,1,2],[0,2,1],[1,0,2],[1,2,0],[2,0,1],[2,1,0]],a=[Shell(e,o,0),Shell(e,o,1),Shell(e,o,2)];let u=!1;function l(t){t.draw(1)}function f(t,e){return t.x>=e.x&&t.y>=e.y&&t.x<=e.x+e.width&&t.y<=e.y+e.height}i.src="start.png",i.onload=()=>{o.src="cup.png"},o.onload=()=>{a.forEach(l),e.drawImage(i,(t.width-i.width)/2,70),a.forEach(t=>t.lift(()=>setTimeout(t.release,500)));const o=()=>{!function t(r){const i=n.value;u=!0;a.forEach(t=>t.release());const o=[...c[Math.random()*c.length>>0]];for(let t=0;t<3;++t)a[t].setNewIndex(o[t]);let f;const s=n=>{f||(f=n);const o=n-f;e.clearRect(0,150,600,250),o<i?(a.forEach(t=>t.draw(o/i)),requestAnimationFrame(s)):(a.forEach(l),r>0?t(r-1):u=!1)};requestAnimationFrame(s)}(r.value)};t.addEventListener("click",throttle(e=>{if(u)return;const n={x:e.offsetX,y:e.offsetY},r={x:(t.width-i.width)/2,y:70,width:i.width,height:i.height},c=a.map(t=>t.getRect());f(n,r)?o():c.forEach((t,e)=>{f(n,t)&&(t=>{a[t].isLifted()?a[t].release():a[t].lift()})(e)})},500))}}();