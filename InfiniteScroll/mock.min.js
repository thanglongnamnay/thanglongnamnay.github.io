const canvas=new OffscreenCanvas(400,300),ctx=canvas.getContext("2d");let currentId=0;function getNewContents(){return new Promise(t=>{const n=[];for(let e=0;e<10;++e){clear(canvas,ctx);const e=5+randInt(5);for(let t=0;t<e;++t)drawPoint(canvas,ctx,randomColor(),randomVector(4/3),25+randInt(75));canvas.convertToBlob().then(e=>{const r=document.createElement("img");r.width=400,r.height=300,r.classList.add("image"+currentId),r.src=URL.createObjectURL(e),currentId%10==9&&observer.observe(r);const a=document.createElement("div");a.classList.add("text-center"),a.textContent="Image "+currentId;const o=document.createElement("div");o.classList.add("stack"),o.appendChild(a),o.appendChild(r),++currentId,n.push(o),10===n.length&&t(n)})}})}function drawPoint(t,n,e,r,a=5){r=r.toWorld(t),n.fillStyle=e,n.beginPath(),n.arc(r.x,r.y,a,0,2*Math.PI,!0),n.fill()}function randInt(t){return Math.random()*t>>0}function randomColor(){return`rgba(${randomShade()}, ${randomShade()}, ${randomShade()}, ${.5+.5*Math.random()})`}function randomShade(){return 256*Math.random()>>0}function randomVector(t){return Vector(Math.random()*t,Math.random())}function clear(t,n){n.fillStyle="#333",n.fillRect(0,0,t.width,t.height)}function throttle(t,n){if(!t)return t;let e=Date.now()-n;return function(...r){Date.now()-e>=n&&(t.apply(this,r),e=Date.now())}}async function wait(t){return new Promise(n=>setTimeout(n,t))}ctx.filter="sepia(.2)";